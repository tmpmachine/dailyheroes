<!DOCTYPE html>
<html>
<head>

  <link href="style.css" rel="stylesheet"/>
  <link href="app.css" rel="stylesheet"/>
  <meta name="viewport" content="width=device-width"/>
  <title>Daily Heroes Timer</title>

</head>
<body>
  
  [ {min-width:430px;max-width:500px;margin:auto;} .d-grid {cols:auto 1fr} {gap:1rem}
  
    <!-- left column, ratio viewer -->
    <section>
      [ {pr:0.5rem} {w:100px} {ov:auto}
        [ #txt-calculate-result-v2 .d-grid {gap:1rem} {white-space:pre}]
        [ .mb-1rem]
        [ #txt-calculate-result .d-grid {gap:1rem} {white-space:pre}]
      ]
    </section>
    
    <!-- right column -->
    <section>
      
      <div class="d-flex justify-content-between">
        <button class="clickable" data-callback='show-modal-add-task'>New Task (Alt + N)</button>
        <!--<button class="clickable" data-callback='export-tasks'>Export</button>-->
        <!--<button class="clickable" data-callback='import-tasks'>Import</button>-->
        <!--<button class="clickable icon-mate" data-callback='manage-tasks'>expand_more</button>-->
        <h3 style="margin:0.5rem">Daily Heroes Timer</h3>
        <button class='clickable d-none' data-callback='reset-progress'>Reset Progress</button>
      </div>
      <div class="default-gap"></div>
      
      <!-- # active task name -->
      [ .d-flex .justify-content-between
        [
          Task : [s @txt-active-task-name] 
        ]
        [
          [button .clickable data-callback='open-task-into-view'
            [small 'Open task']
          ]
        ]
      ]
      [ .mb-xs]
      
      <!-- # progress bar -->
      <div class="NzE2ODYyNQ-progress-bar-container">
        <div class="NzE2ODYyNQ-progress-bar">
          <div class="NzE2ODYyNQ-progress-bar-fill"></div>
          <span class="NzE2ODYyNQ-progress-bar-text"><span id="txt-countdown">00:00:00</span></span>
        </div>
      </div>
      [ .d-none
        <div style="height:2px;"></div>
        <div class="progress-bar-container">
          <div class="progress-bar">
            <div class="progress-bar-fill"></div>
            <span class="progress-bar-text"><span id="percentage"></span></span>
          </div>
        </div>
      ]
      <div class="default-gap"></div>
      <div data-obj="stop-timer">
        [
          Timer
        ]
        [ .d-grid {gap:0.35rem} {cols:1fr 1fr}
          <button class='clickable btn-timer-control-stop' data-callback='stop-timer'>
            Stop [small '(Alt + S)']
          </button>
          <button class='clickable btn-timer-control-start' data-callback='start-or-restart-timer'>
            Start [small '(Alt + S)']
          </button>
          <button class='clickable d-none' data-callback='finish-timer'>Finish (F)</button>
        ]
      </div>
      <div class="default-gap"></div>
      
      <!-- TASK LIST -->
      <div data-section="import">
        import goes here
        <form class="submittable d-grid" data-callback='import-tasks'>
          <textarea name='tasksString'></textarea>
          <button>import</button>
        </form>
      </div>
      
      [ .d-none
        [ {d:grid} {cols:1fr 1fr} {pb:1rem}
          [btn 'Active' .clickable data-callback='show-active']
          [btn 'Completed' .clickable data-callback='show-completed']
        ]
      ]

      Search :
      <input id="node-filter-box" type="text" placeholder="Search" class="inputable input-style-default" data-callback="save-word-template"/>
      [ .d-none
        Filter by label :
        [in .inputable .input-style-default data-callback="save-label-filter" #in-filter-search-label]
      ]
      <div class="default-gap"></div>
      [ .d-grid {cols:1fr 1fr}
        [btn 'All Tasks' .clickable data-callback='view-tasks']
        [btn 'Missions' .clickable data-callback='view-mission']
      ]
      <div class="default-gap"></div>
      
      [ .d-flex .justify-content-between
        [ #container-breadcrumbs]
        [ #txt-total-ratio]
      ]
            
      <div class="default-gap"></div>
      <div class="default-gap"></div>
      
      <div id="tasklist-container" class="container-task">
        <div id="tasklist" class="clickable" data-callback="task-click-handler"></div>
        <div style="padding-top:1rem;"></div>
        <div id="tasklist-completed" class="clickable" data-callback="task-click-handler"></div>
      </div>
      
      [ .d-flex .justify-content-between
        [
          [btn 'Get Report' .clickable data-callback='get-report' .d-none]
        ]
        [ .d-none
          [btn 'Settings' .clickable data-callback='ratio-settings']
          [btn 'Ratio' .clickable data-callback='ratio-config']
        ]
        [btn 'Reset history' .clickable data-callback='reset-history' .d-none]
      ]
      
      <!-- # ratio config -->
      [ .d-grid {gap:0.2rem} {mt:1rem} .container-ratio-config .d-none
        [small 'Ratio config']
        [t {h:200px} #in-ratio-settings]
        [btn 'Save' .clickable data-callback='save-ratio']
      ]
      
    </section>
    <section class="d-none">
      
      <div>
        
        <div class="d-none">
          <div style="display:flex;align-items:center;">
            <div id="txt-clock" style="flex-grow:1;font-weight:bold;"></div>
            <div style="text-align:right;flex-grow:1">
              Sleep : <span id="txt-sleeptime">not set</span>
              <button class="clickable" data-callback='set-sleep-time' style="font-size:0.7rem;">Edit</button>
            </div>
          </div>
          <div class="default-gap"></div>
        
          <div>Today's :</div>
          <div class="default-gap"></div>
        </div>
        
        <div class="d-none">
          <div class="default-gap"></div>
          <div style="font-weight:bold;text-align:center;">
            <span id="history"></span><span id="live-history"></span> / <span id="target"></span>
          </div>    
            <div style="text-align:center;">
              Time before sleep : <span id="txt-time-before-sleep"></span>
            </div>
            <div style="text-align:center;">
              Unallocated time : <span id="txt-unallocated-time"></span>
            </div>
        
          <div class="default-gap"></div>
          <div style="text-align:center;">
            <span id="txt-time-overload-info" style="color:red;"></span>
          </div>
        </div>
      </div>
      
      <div class="d-none">
        Take a rest : <span id="txt-left-until-rest" style="font-weight:bold;"></span>
        <div id="rest-time" class="default-inline-flex-gap"></div>
        <div class="default-gap"></div>
      </div>
      
      Set timer (T) :
      <div>
        <small>Duration or time. e.g. 1h30m or 04:30PM</small>
      </div>
      <div class="default-gap"></div>
      <form class="submittable" data-callback='set-timer'>
        <div style="display:flex;gap:0.3rem;">
          <div>
            <input type="text" name="target" class="input-style-default"/>
          </div>
          <button>Set</button>
        </div>
      </form>
      <div class="default-gap"></div>
      
      Timer preset :
      <div class="default-gap"></div>
      <div id="preset-button" style="display:grid;grid-template-columns:1fr 1fr;gap:3px;">
        <button autofocus class='clickable' data-callback='set-alarm' data-time='12'>12m</button>
        <button class='clickable' data-callback='set-alarm' data-time='20'>20m</button>
        <button class='clickable' data-callback='set-alarm' data-time='25'>25m</button>
        <button class='clickable' data-callback='set-alarm' data-time='30'>30m</button>
      </div>
      <div class="default-gap"></div>
      
      
      <!--Set mode : -->
      <!--<button class="clickable" data-callback='mode-work-day'>work day</button>-->
      <!--<button class="clickable" data-callback='mode-day-off'>day off</button>-->
      
      <!--<div style="padding-top:1rem;"></div>-->
      
    </section>
  
  ]
  
  
  
  <!-- TEMPLATES -->
  
  <!-- # container task -->
  <template id="tmp-task">
    
  	[ .container-item data-obj="task" data-id="?" data-kind="task"
  	  
      [ .d-flex .justify-content-between
        [ .d-flex
          <button class="btn-star icon-mate" data-role='star-task' title="Star this task">star</button>
          <button data-role='remove-mission' class="icon-mate" title='Remove from mission'>close</button>
          <button data-role='add-to-mission' class="icon-mate" title='Add to mission'>add</button>
          <button data-role='add-sub-timer' class="icon-mate" data-group="active" title='Create sub timer'>timer</button>
          [ .d-flex .align-items-center {p:0 0.5rem} {gap:0.3rem} {fs:10px}
            <span data-slot="ratio"></span>
            <span data-slot="ratioTimeLeftStr" data-slot-html></span>
          ]
        ]
        [ .d-flex
          [ .container-navigate-mission .d-none
            [btn data-role='navigate-mission' title='Open mission into view' .icon-mate 'open_in_new']
          ]
          [ .container-navigate .d-none .d-flex
            [btn data-role='navigate-sub' title='View sub missions' .icon-mate 'chevron_right']
          ]
        ]
      ]
  	  
  	  <div style="padding:0.3rem 0.5rem;">
    	  <div class="d-flex justify-content-between">
    	    [
      	    [ data-slot="missionPath" data-slot-html]
      	    <span data-slot="title"></span>
    	    ]
    	    [ .d-none
    	      <span data-slot="label"></span>
    	    ]
          [ {fs:0.7rem}
            [ .d-none
              <span data-slot="totalProgressLabel"></span>
            ]
            <span data-slot="rankLabel"></span>
            [s .label-finish-count]
          ]
    	  </div>
        <div style="margin-top:0.7rem"></div>
    	  <div class="default-inline-flex-gap" data-slot="" data-template="#tmp-mission-buttons">
    	  </div>
    	 
    	  <!--task notes-->
    	  <div style="margin-top:1rem;">
    	    <div data-slot="note" data-template='#tmp-notes'></div>
    	  </div>
  	  
  	  </div>
  	  
      <div data-obj="tracking-status" style="height:4px;"></div>
    	
    	
    	<div style="padding:2px 4px;font-size:0.7rem;display:flex;">
        [ {flex:1} 
      	  <span data-obj="progress" data-slot="progress"></span><span data-obj="live-progress"></span> / <small data-slot="allocatedTimeString"></small>
    	  ]
    	  [
  	      <span data-slot="targetString"></span> 
  	      <span class="d-none" data-slot="completionPercentage"></span>
    	  ]
    	</div>
    	<!-- # running task indicator -->
    	<div class="task-progress-bar-container">
        <div class="task-progress-bar"></div>
      </div>
    	[ .d-none
      	<div class="NzA5ODc1NQ-progress-bar-container">
          <div class="NzA5ODc1NQ-progress-bar" data-role="progress-bar-container">
            <div data-role="progress-bar" class="NzA5ODc1NQ-progress-bar-fill"></div>
          </div>
        </div>
    	]
      
  	]
  </template>

  <template id="tmp-mission-buttons">
    <button data-role='set-active' class="icon-mate" title='Focus on this task' data-group="not-running unarchived">track_changes</button>
    <!--<button data-role='split-task' class="icon-mate" title='split'>call_split</button>-->
    <button data-role='delete' class="icon-mate" data-group="not-running" title='Delete'>delete</button>
    <!--<button data-role='reduce' class="icon-mate">remove</button>-->
    <!--<button data-role='add' class="icon-mate">add</button>-->
    <button data-role='set-target' class="icon-mate" data-group="active" title='Change target'>schedule</button>
    <!--<button data-role='rename' class="icon-mate" title='Rename'>edit</button>-->
    <button data-role='edit' class="icon-mate" title='Setting'>edit</button>
    <button data-role='archive' class="icon-mate" data-group="not-running unarchived" title='Archive'>archive</button>
    <button data-role='unarchive' class="icon-mate" data-group="archived" title='Unarchive'>unarchive</button>
    <button data-role='restart' class="icon-mate" data-group="not-running" title='Restart'>restart_alt</button>
    <button data-role='take-note' class="icon-mate d-none" data-group="active" title='Take a note'>note_add</button>
    <button data-role='add-progress-minutes' class="icon-mate" data-group="active not-running" title='Add progress manually'>add</button>
    <button data-role='set-ratio' title='Set ratio' class="icon-mate">percent</button>
    <!-- <button data-role='add-label' class="icon-mate">label</button> -->
    <button data-role='start' class="icon-mate" data-group="active not-running" title='Start'>play_arrow</button>
    <div style="padding-top:4px;"></div>
    <div data-role="manage" class="default-inline-flex-gap">
      <button data-role='track'>Track</button>
      <button data-role='untrack'>Untrack</button>
    </div>
  </template>
  
  <template id='tmp-notes'>
    <div data-kind="note" class="i-item align-items-center">
      [s .d-none data-slot='id']
      <div class="d-none" data-slot='index'></div>

      [ .d-flex .justify-content-between
        [
          <div data-kind='note.desc' data-slot='desc'></div>
          [ {fs:.7em} {op:0.8;fw:bold}
            [s '' data-slot='progressTimeLabel'][s data-kind='progress']
          ]
        ]
        [ 
          [ {pt:.3rem}]
          [btn data-role='rename-sub-task' {p:0 4px} .icon-mate 'edit']
          [btn data-role='start-sub-task' {p:0 4px} .icon-mate 'play_arrow']
          [btn data-role='delete-note' {p:0 4px} .icon-mate 'close']
        ]
      ]
    </div>
  </template>

  <modal-v2 id="projects-modal">
    <div class="modal" slot="content">
      <!-- modal content-->
      <div class="ov-auto">
        <div style="padding:1rem;">

          New task :
          <div class="default-gap"></div>
          <form data-name='task' class='submittable default-inline-flex-gap flex-column' data-callback='submit-task' data-obj="form-task">
            <input type="hidden" name="id"/>
            <div>
              Title <input type="text" name='title' class="input-style-default"/>
            </div>
            <div>
              Duration <input type="text" name='target' placeholder='example: 1h, 30m, or 1h30m' class="input-style-default" value="15m"/>
            </div>
            <div>
              Repeat count (leave blank for none) <input type="number" min="1" name='finishCount' class="input-style-default"/>
            </div>
            [
              Parent Id <input type="text" name='parent-id' class="input-style-default"/>
            ]
            [ .mb-m]
            <div>
              <button data-role='btn-add'>Add</button>
              <button data-role="btn-edit">Update</button>
            </div>
          </form>

        </div>
      </div>
    </div>
  </modal-v2>

  <modal-v2 id="modal-note" class="is-modal">
    <div class="modal" slot="content">
      <!-- modal content-->
      <div class="ov-auto">
        <div style="padding:1rem;">

          New Note :
          <div class="default-gap"></div>
          <form class='submittable default-inline-flex-gap flex-column' data-callback='add-note'>
            <input type="hidden" name="id"/>
            <div>
              <input type="text" name='title' class="input-style-default"/>
            </div>
            <div>
              <button data-role='btn-add'>Add</button>
            </div>
          </form>

        </div>
      </div>
    </div>
  </modal-v2>
  
  <link href="modal-v2.css" rel="stylesheet"/>
  <script src='modal-v2.js'></script>

  <script src="service.js"></script>
  <script src="service-chrome.js"></script>
  <script src="lib/mousetrap.min.js"></script>
  <script src="lib/statelist@v1.0.2.min.js"></script>
  <script src='lib/templateslot.min.js'></script>
  
  <script src='js/component-loader.js'></script>
  <script src='index.js'></script>

</body>
</html>